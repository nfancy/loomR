% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/loom.R
\docType{class}
\name{loom-class}
\alias{loom-class}
\alias{loom}
\title{A class for connections loom files}
\format{An \code{\link{R6::R6Class}} object}
\usage{
loom
}
\description{
A class for connections loom files
}
\section{Fields}{

\describe{
\item{\code{version}}{Version of loomR object was created under}

\item{\code{shape}}{Shape of \code{/matrix} in features (columns) by cells (rows)}

\item{\code{matrix}}{The main data matrix, stored as columns (cells) by rows (features)}

\item{\code{layers}}{Additional data matricies, the same shape as \code{/matrix}}

\item{\code{col.attrs}}{Extra information about cells}

\item{\code{row.attrs}}{Extra information about features}
}}

\section{Methods}{

\describe{
  \item{\code{add.graph(a, b, w, name, MARGIN, overwrite)}, \code{add.graph.matrix(mat, name, MARGIN, overwrite)}}{
    Add a graph to the loom object; can add either in coorindate format (\code{add.graph}) or matrix format (\code{add.graph.matrix}).
    Stores graph in coordinate format as \code{[row, col]_graphs/name/a} (row indices),
    \code{[row, col]_graphs/name/b} (column indices), and \code{[row, col]_graphs/name/w} (values)
    \describe{
      \item{\code{a}}{Integer vector of row indices for graph, must be the same lengths as \code{b} and \code{w}}
      \item{\code{b}}{Integer vector of column indices for graph, must be the same lengths as \code{a} and \code{w}}
      \item{\code{w}}{Numeric vector of values for graph, must be the same lengths as \code{a} and \code{b}}
      \item{\code{mat}}{Graph provided as a matrix (sparse or dense) or data.frame}
      \item{\code{name}}{Name to store graph, will end up being \code{col_graphs/name} or \code{row_graphs/name}, depending on \code{MARGIN}}
      \item{\code{MARGIN}}{Store the graph in \code{row_graphs} (1) or \code{col_graphs} (2), defaults to 2}
      \item{\code{overwrite}}{Can overwrite existing graph?}
    }
  }
  \item{\code{add.layer(layers, overwrite)}}{
    Add a data layer to this loom file, must be the same dimensions as \code{/matrix}
    \describe{
      \item{\code{layers}}{A named list of matrices to be added as layers}
      \item{\code{overwrite}}{If a layer already exists, overwrite with new data, defaults to FALSE}
    }
  }
  \item{\code{add.attribute(attribute, MARGIN, overwrite)}}{
    Add extra information to this loom file.
    \describe{
      \item{\code{attributes}}{A named list where the first dimmension of each element as long as one dimension of \code{/matrix}}
      \item{\code{MARGIN}}{Either 1 for features or 2 for cells}
      \item{\code{overwrite}}{Can overwrite existing attributes?}
    }
  }
  \item{\code{add.row.attribute(attributes), add.col.attribute(attributes)}}{
    Add row or column attributes
  }
  \item{\code{get.attribute.df(MARGIN, attributes, row.names, col.names)}}{
    Get a group of row or column attributes as a data frame, will only return attributes that have one dimension
    \describe{
      \item{\code{MARGIN}}{Either '1' or '2' to get row- or column-attributes, respectively}
      \item{\code{attributes}}{A vector of attribute dataset basenames}
      \item{\code{row.names}}{Basename of the rownames dataset}
      \item{\code{col.names}}{Basename of the colnames dataset}
    }
  }
  \item{\code{get.graph(name, MARGIN)}}{
    Get a graph as a sparse matrix
    \describe{
      \item{\code{name}}{Name of the graph, can be either the basename or full name of the grpah}
      \item{\code{MARGIN}}{
        Load the graph from \code{row_graphs} (1) or \code{col_graphs} (2), defaults to 2.
        Ignored if full path to graph is passed to \code{name}
      }
    }
  }
  \item{\code{get.sparse(dataset, features, cells, chunk.size, feature.names, cell.names, verbose)}}{
    Get a sparse matrix representation of a dataset
    \describe{
      \item{\code{dataset}}{Dataset to be returned as a sparse matrix}
      \item{\code{features}}{Vector of indices of features to return}
      \item{\code{cells}}{Vector of indices of cells to return}
      \item{\code{chunk.size}}{Number of cells to iterate through at a time}
      \item{\code{feature.names}}{Dataset to feature names}
      \item{\code{cell.names}}{Dataset to cell names}
      \item{\code{verbose}}{Display a progress bar}
    }
  }
  \item{\code{chunk.points(chunk.size = NULL, MARGIN = 2, dataset = 'matrix')}, \code{chunk.indices(chunk.size = NULL, MARGIN = 2, dataset = 'matrix')}}{
    Generate start/end points or indices of chunk size \code{chunk.size} for iteration
    \describe{
      \item{\code{chunk.size}}{Size to chunk \code{MARGIN} by, defaults to \code{self[[dataset]]$chunk_dims}}
      \item{\code{MARGIN}}{Iterate over features (1) or cells (2), defaults to 2}
      \item{\code{dataset}}{Name of dataset to use, can be the name, not \code{group/name}, unless the name is present in multiple groups}
    }
  }
  \item{\code{scan(dataset = 'matrix', MARGIN = 2, chunk.size = NULL, index = NULL, verbose = TRUE)}}{
    Scan through a dataset
    \describe{
      \item{\code{dataset}}{Name of dataset to use, can be the name, not \code{group/name}, unless the name is present in multiple groups}
      \item{\code{chunk.size}}{Size to chunk \code{MARGIN} by, defaults to \code{self$chunksize}}
      \item{\code{MARGIN}}{Iterate over features (1) or cells (2), defaults to 2}
      \item{\code{index}}{Which specific values of \code{dataset} to use, defaults to \code{1:self$shape[MARGIN]} (all values)}
      \item{\code{verbose}}{Display a progress bar}
    }
  }
  \item{\code{apply(name, FUN, MARGIN, chunk.size, dataset, overwrite, verbose, ...)}}{
    Apply a function over a dataset within the loom file, stores the results in the loom file. Will not make multidimensional attributes.
    \describe{
      \item{\code{name}}{Full name ('group/name') of dataset to store results to}
      \item{\code{FUN}}{Function to apply}
      \item{\code{MARGIN}}{Iterate over features (1) or cells (2), defaults to 2}
      \item{\code{index}}{Which specific values of \code{dataset} to use, defaults to \code{1:self$shape[MARGIN]} (all values)}
      \item{\code{chunk.size}}{Size to chunk \code{MARGIN} by, defaults to \code{self$chunksize}}
      \item{\code{dataset}}{Name of dataset to use}
      \item{\code{overwrite}}{Overite \code{name} if already exists}
      \item{\code{verbose}}{Display progress}
      \item{\code{max.size}}{Maximum HDF5 chunk size}
      \item{\code{chunk.dims}}{HDF5 chunk dimensions}
      \item{\code{verbose}}{Display a progress bar}
      \item{\code{...}}{Extra parameters to pass to \code{FUN}}
    }
  }
  \item{\code{map(FUN, MARGIN, chunk.size, index, dataset, verbose, expected, ...)}}{
    Map a function onto a dataset within the loom file, returns the result into R.
    \describe{
      \item{\code{FUN}}{}
      \item{\code{MARGIN}}{Iterate over features (1) or cells (2), defaults to 2}
      \item{\code{chunk.size}}{Size to chunk \code{MARGIN} by, defaults to \code{self$chunksize}}
      \item{\code{index}}{Which specific values of \code{dataset} to use, defaults to \code{1:self$shape[MARGIN]} (all values)}
      \item{\code{dataset}}{Name of dataset to use}
      \item{\code{verbose}}{Display a progress bar}
      \item{\code{...}}{Extra parameters to pass to \code{FUN}}
    }
  }
  \item{\code{add.cells(matrix.data, attributes.data = NULL, layers.data = NULL, verbose = TRUE)}}{
    Add cells to a loom file.
    \describe{
      \item{\code{matrix.data}}{A list of m2 cells where each entry is a vector of length n (num features, \code{self$shape[1]})}
      \item{\code{attributes.data}}{A list where each entry is named for one of the datasets in \code{self[['col_attrs']]}; each entry is a vector of length m2.}
      \item{\code{layers.data}}{A list where each entry is named for one of the datasets in \code{self[['layers']]}; each entry is an n-by-m2 matrix where n is the number of features in this loom file and m2 is the number of cells being added.}
      \item{\code{verbose}}{Display a progress bar}
    }
  }
  \item{\code{add.loom(other, other.key, self.key, ...)}}{
    Add the contents of another loom file to this one.
    \describe{
      \item{\code{other}}{An object of class \code{loom} or a filename of another loom file}
      \item{\code{other.key}}{Row attribute in \code{other} to add by}
      \item{\code{self.key}}{Row attribute in this loom file to add by}
      \item{\code{...}}{Ignored for now}
    }
  }
  \item{\code{last.modified(x = 'self')}}{
    Get the time an object (group, dataset, file) was most recently modified
    \describe{
      \item{\code{x}}{A character vector of groups or datasets to get the timestamp of, defaults to 'self' or the file as a whole; pass \code{NULL} to get all timestamps present}
    }
  }
  \item{\code{get.changes.since(x)}}{
    Get changes since a given time
    \describe{
      \item{\code{x}}{An object of class \code{POSIXct}}
    }
  }
}
}

\seealso{
\code{\link{loomR}}, \code{\link{hdf5r::H5File}}
}
\keyword{datasets}
